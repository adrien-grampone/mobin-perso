{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useState, useEffect } from 'react';\nimport { Container, Box, Grid, FormControl, InputLabel, Select, MenuItem, Input, Button } from '@material-ui/core';\nimport { Layout, Title, AdherentPreview } from '../../../../components';\nimport { useRouter } from 'next/router';\nimport { getDepartments, getAdherents, getCoordinateurs, filterAdherentsFromSelectedDepartments, getExpertises, filterAdherentsFromSelectedExpertises } from '../../../../utils';\nimport { makeStyles } from '@material-ui/core/styles';\nconst useStyles = makeStyles(theme => ({\n  banner: {\n    // border: `1px ${theme.palette.orange.main} solid`,\n    borderRadius: \"10px\",\n    padding: \"1em\",\n    marginBottom: '1em',\n    textAlign: 'left'\n  },\n  cell: {\n    verticalAlign: 'top'\n  },\n  mainImage: {\n    width: \"100%\",\n    maxHeight: \"200px\",\n    objectFit: \"contain\",\n    marginBottom: '1em'\n  },\n  gridItem: {\n    textAlign: \"center\",\n    justifyContent: \"center\"\n  },\n  formControl: {\n    margin: '1em',\n    minWidth: \"100%\" // maxWidth: 300,\n\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  },\n  chip: {\n    margin: 2\n  },\n  noLabel: {\n    marginTop: \"1em\"\n  },\n  inputLabel: {\n    fontSize: '15px'\n  },\n  grid: {// textAlign: 'center'\n  },\n  box: {\n    display: \"flex\",\n    flexDirection: \"column\" // justifyContent: \"center\"\n\n  },\n  coordBox: {\n    borderTop: `4px solid ${theme.palette.orange.main}`,\n    borderBottom: `4px solid ${theme.palette.orange.main}`,\n    \"@media (min-width: 960px)\": {\n      position: \"-webkit-sticky\",\n      position: \"sticky\",\n      top: \"0px\"\n    }\n  },\n  item1: {\n    order: 1,\n    [theme.breakpoints.down('sm')]: {\n      order: 2\n    }\n  },\n  item2: {\n    order: 2,\n    [theme.breakpoints.down('sm')]: {\n      order: 1\n    }\n  },\n  btn: {\n    textTransform: 'none' // textDecoration: \"underline\"\n\n  }\n}));\nconst ITEM_HEIGHT = 48;\nconst ITEM_PADDING_TOP = 8;\nconst MenuProps = {\n  PaperProps: {\n    style: {\n      maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\n      width: 250\n    }\n  }\n};\n\nconst Region = ({\n  departments = [],\n  adherents = [],\n  coordinateurs = [],\n  expertises = []\n}) => {\n  var _uniqueCoordinateur$l;\n\n  const classes = useStyles();\n  const router = useRouter();\n  const {\n    region\n  } = router.query;\n  const {\n    0: mainDepartementSelected,\n    1: setMainDepartmentSelected\n  } = useState([]);\n  const {\n    0: mainExpertiseSelected,\n    1: setMainExpertiseSelected\n  } = useState([]);\n  const adherentsFiltered = adherents.filter(adh => {\n    var _adh$region_siege;\n\n    return (adh === null || adh === void 0 ? void 0 : (_adh$region_siege = adh.region_siege) === null || _adh$region_siege === void 0 ? void 0 : _adh$region_siege.nom_region) === region;\n  });\n  const {\n    0: adherentsToDisplay,\n    1: setAdherentsToDisplay\n  } = useState(adherents.filter(adh => {\n    var _adh$region_siege2;\n\n    return (adh === null || adh === void 0 ? void 0 : (_adh$region_siege2 = adh.region_siege) === null || _adh$region_siege2 === void 0 ? void 0 : _adh$region_siege2.nom_region) === region;\n  }));\n  const {\n    0: adherentsToDisplayExpertise,\n    1: setAdherentsToDisplayExpertise\n  } = useState(adherents.filter(adh => {\n    var _adh$region_siege3;\n\n    return (adh === null || adh === void 0 ? void 0 : (_adh$region_siege3 = adh.region_siege) === null || _adh$region_siege3 === void 0 ? void 0 : _adh$region_siege3.nom_region) === region;\n  })); // Get filtered Departments\n\n  const regionDepartments = departments.filter(dep => {\n    var _dep$region;\n\n    return (dep === null || dep === void 0 ? void 0 : (_dep$region = dep.region) === null || _dep$region === void 0 ? void 0 : _dep$region.nom_region) === region;\n  }); // Get filtered coordinateur\n\n  const uniqueCoordinateur = coordinateurs.find(c => {\n    var _c$region;\n\n    return (c === null || c === void 0 ? void 0 : (_c$region = c.region) === null || _c$region === void 0 ? void 0 : _c$region.nom_region) === region;\n  });\n\n  const getStyles = (departement, mainDepartementSelected) => {\n    return {\n      fontWeight: mainDepartementSelected.indexOf(departement) === -1 ? \"normal\" : \"bold\"\n    };\n  };\n\n  const getStylesExp = (exp, mainExpertiseSelected) => {\n    return {\n      fontWeight: mainExpertiseSelected.indexOf(exp) === -1 ? \"normal\" : \"bold\"\n    };\n  };\n\n  useEffect(() => {\n    const resultDeps = filterAdherentsFromSelectedDepartments(adherentsFiltered, mainDepartementSelected);\n    setAdherentsToDisplay(resultDeps);\n  }, [mainDepartementSelected]);\n  useEffect(() => {\n    const resultExp = filterAdherentsFromSelectedExpertises(adherentsFiltered, mainExpertiseSelected);\n    setAdherentsToDisplayExpertise(resultExp);\n  }, [mainExpertiseSelected]); // Get filtered Regions\n\n  const regionAdherents = adherentsToDisplay.filter(element => adherentsToDisplayExpertise.includes(element));\n  const isWindowContext = false;\n\n  const _handleClick = site => {\n    let url = site;\n    let prefixHttp = 'http://';\n    let prefixHttps = 'https://';\n\n    if (url.substr(0, prefixHttp.length) !== prefixHttp && url.substr(0, prefixHttps.length) !== prefixHttps) {\n      url = prefix + url;\n    }\n\n    if (isWindowContext) {\n      window.open(url, '_blank');\n    }\n  };\n\n  return /*#__PURE__*/_jsx(Layout, {\n    children: /*#__PURE__*/_jsx(Box, {\n      mt: 7,\n      children: /*#__PURE__*/_jsxs(Container, {\n        maxWidth: \"lg\",\n        children: [/*#__PURE__*/_jsx(Grid, {\n          container: true,\n          children: /*#__PURE__*/_jsx(Grid, {\n            item: true,\n            xs: 12,\n            md: 12,\n            children: /*#__PURE__*/_jsx(Box, {\n              mb: 4,\n              children: /*#__PURE__*/_jsx(Title, {\n                color: \"#2699b0\",\n                content: `Mobâ€™In ${region}`,\n                size: \"h4\",\n                bold: true,\n                letterspacing: \"2px\"\n              })\n            })\n          })\n        }), /*#__PURE__*/_jsxs(Grid, {\n          container: true,\n          spacing: 2,\n          children: [/*#__PURE__*/_jsx(Grid, {\n            item: true,\n            xs: 12,\n            md: 8,\n            className: classes.item1,\n            children: /*#__PURE__*/_jsxs(Box, {\n              mb: 5,\n              pr: 7,\n              children: [/*#__PURE__*/_jsx(Title, {\n                color: \"black\",\n                content: \"Toutes les structures\",\n                size: \"h6\",\n                uppercase: true,\n                bold: true,\n                letterspacing: \"2px\"\n              }), /*#__PURE__*/_jsx(Title, {\n                color: \"black\",\n                content: \"Filtrer les r\\xE9sultats :\",\n                size: \"h6\",\n                uppercase: true,\n                italic: true,\n                bold: true,\n                letterspacing: \"2px\",\n                fontSize: \"12px\"\n              }), /*#__PURE__*/_jsxs(Grid, {\n                container: true,\n                children: [/*#__PURE__*/_jsx(Grid, {\n                  item: true,\n                  xs: 12,\n                  className: classes.grid,\n                  children: /*#__PURE__*/_jsxs(FormControl, {\n                    className: classes.formControl,\n                    children: [/*#__PURE__*/_jsx(InputLabel, {\n                      className: classes.inputLabel,\n                      children: \"D\\xE9partement\"\n                    }), /*#__PURE__*/_jsx(Select, {\n                      multiple: true,\n                      value: mainDepartementSelected // onChange={handleChangeDepartment}\n                      ,\n                      onChange: event => setMainDepartmentSelected(event.target.value),\n                      input: /*#__PURE__*/_jsx(Input, {}),\n                      MenuProps: MenuProps,\n                      children: regionDepartments.map((dep, index) => /*#__PURE__*/_jsx(MenuItem, {\n                        value: dep.nom_departement,\n                        style: getStyles(dep.nom_departement, mainDepartementSelected),\n                        children: dep.nom_departement\n                      }, index))\n                    })]\n                  })\n                }), /*#__PURE__*/_jsx(Grid, {\n                  item: true,\n                  xs: 12,\n                  children: /*#__PURE__*/_jsxs(FormControl, {\n                    className: classes.formControl,\n                    children: [/*#__PURE__*/_jsx(InputLabel, {\n                      className: classes.inputLabel,\n                      children: \"Expertise\"\n                    }), /*#__PURE__*/_jsx(Select, {\n                      multiple: true,\n                      value: mainExpertiseSelected // onChange={handleChangeDepartment}\n                      ,\n                      onChange: event => setMainExpertiseSelected(event.target.value),\n                      input: /*#__PURE__*/_jsx(Input, {}),\n                      MenuProps: MenuProps,\n                      children: expertises.map((exp, index) => /*#__PURE__*/_jsx(MenuItem, {\n                        value: exp.type,\n                        style: getStylesExp(exp.type, mainExpertiseSelected),\n                        children: exp.type\n                      }, index))\n                    })]\n                  })\n                })]\n              }), regionDepartments.map((dep, index) => /*#__PURE__*/_jsxs(Box, {\n                mt: 3,\n                children: [/*#__PURE__*/_jsx(Box, {\n                  children: /*#__PURE__*/_jsx(Title, {\n                    color: \"black\",\n                    content: dep.nom_departement || \"\",\n                    size: \"h6\",\n                    uppercase: true,\n                    bold: true,\n                    letterspacing: \"2px\",\n                    fontSize: \"12px\"\n                  })\n                }), /*#__PURE__*/_jsx(Grid, {\n                  container: true,\n                  children: regionAdherents.filter(adh => adh.departement_siege.nom_departement === dep.nom_departement).map((d, i) => /*#__PURE__*/_jsx(AdherentPreview, {\n                    adherent: d\n                  }, i))\n                })]\n              }, index))]\n            })\n          }), /*#__PURE__*/_jsx(Grid, {\n            item: true,\n            xs: 12,\n            md: 4,\n            className: classes.item2,\n            children: /*#__PURE__*/_jsxs(Grid, {\n              container: true,\n              spacing: 2,\n              className: classes.coordBox,\n              children: [/*#__PURE__*/_jsx(Grid, {\n                item: true,\n                xs: 3,\n                className: classes.box,\n                children: uniqueCoordinateur && uniqueCoordinateur.logo && /*#__PURE__*/_jsx(\"img\", {\n                  className: classes.mainImage,\n                  src: uniqueCoordinateur === null || uniqueCoordinateur === void 0 ? void 0 : (_uniqueCoordinateur$l = uniqueCoordinateur.logo) === null || _uniqueCoordinateur$l === void 0 ? void 0 : _uniqueCoordinateur$l.url,\n                  alt: \"mobilite\"\n                })\n              }), /*#__PURE__*/_jsx(Grid, {\n                item: true,\n                xs: 9,\n                className: classes.box,\n                children: uniqueCoordinateur && /*#__PURE__*/_jsx(Grid, {\n                  container: true,\n                  spacing: 3,\n                  children: /*#__PURE__*/_jsx(Grid, {\n                    item: true,\n                    className: classes.gridItem,\n                    xs: 12,\n                    sm: 12,\n                    md: 12,\n                    children: /*#__PURE__*/_jsxs(Box, {\n                      className: classes.banner,\n                      children: [/*#__PURE__*/_jsxs(Grid, {\n                        container: true,\n                        spacing: 2,\n                        children: [/*#__PURE__*/_jsx(Grid, {\n                          item: true,\n                          xs: 6,\n                          children: /*#__PURE__*/_jsx(Title, {\n                            fontSize: \"16px\",\n                            color: \"black\",\n                            bold: true,\n                            content: \"Pr\\xE9sident de r\\xE9gion\"\n                          })\n                        }), /*#__PURE__*/_jsxs(Grid, {\n                          item: true,\n                          xs: 6,\n                          children: [uniqueCoordinateur.nom_president && /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"16px\",\n                              color: \"#2699b0\",\n                              bold: true,\n                              content: uniqueCoordinateur.nom_president || \"\"\n                            })\n                          }), /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"13px\",\n                              color: \"black\",\n                              bold: true,\n                              content: uniqueCoordinateur.telephone_president || \"\"\n                            })\n                          }), /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"13px\",\n                              color: \"black\",\n                              bold: true,\n                              content: /*#__PURE__*/_jsx(\"a\", {\n                                href: `mailto:${uniqueCoordinateur.email_president}`,\n                                children: uniqueCoordinateur.email_president\n                              }) || \"\"\n                            })\n                          })]\n                        })]\n                      }), /*#__PURE__*/_jsxs(Grid, {\n                        container: true,\n                        spacing: 2,\n                        children: [/*#__PURE__*/_jsx(Grid, {\n                          item: true,\n                          xs: 6,\n                          children: uniqueCoordinateur.nom_co_president && /*#__PURE__*/_jsx(Title, {\n                            fontSize: \"16px\",\n                            color: \"black\",\n                            bold: true,\n                            content: \"Co-Pr\\xE9sident de r\\xE9gion\"\n                          })\n                        }), /*#__PURE__*/_jsxs(Grid, {\n                          item: true,\n                          xs: 6,\n                          children: [/*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"16px\",\n                              color: \"#2699b0\",\n                              bold: true,\n                              content: uniqueCoordinateur.nom_co_president || \"\"\n                            })\n                          }), /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"13px\",\n                              color: \"black\",\n                              bold: true,\n                              content: uniqueCoordinateur.telephone_co_president || \"\"\n                            })\n                          }), /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"13px\",\n                              color: \"black\",\n                              bold: true,\n                              content: /*#__PURE__*/_jsx(\"a\", {\n                                href: `mailto:${uniqueCoordinateur.email_co_president}`,\n                                children: uniqueCoordinateur.email_co_president\n                              }) || \"\"\n                            })\n                          })]\n                        })]\n                      }), uniqueCoordinateur.nom_charge_developpement && /*#__PURE__*/_jsxs(Grid, {\n                        container: true,\n                        spacing: 2,\n                        children: [/*#__PURE__*/_jsx(Grid, {\n                          item: true,\n                          xs: 6,\n                          children: uniqueCoordinateur.nom_charge_developpement && /*#__PURE__*/_jsx(Title, {\n                            fontSize: \"16px\",\n                            color: \"black\",\n                            bold: true,\n                            content: \"Charg\\xE9.e de d\\xE9veloppement\"\n                          })\n                        }), /*#__PURE__*/_jsxs(Grid, {\n                          item: true,\n                          xs: 6,\n                          children: [/*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"16px\",\n                              color: \"#2699b0\",\n                              bold: true,\n                              content: uniqueCoordinateur.nom_charge_developpement || \"\"\n                            })\n                          }), /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"13px\",\n                              color: \"black\",\n                              bold: true,\n                              content: uniqueCoordinateur.telephone_charge_developpement || \"\"\n                            })\n                          }), /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Title, {\n                              fontSize: \"13px\",\n                              color: \"black\",\n                              bold: true,\n                              content: /*#__PURE__*/_jsx(\"a\", {\n                                href: `mailto:${uniqueCoordinateur.email_charge_developpement}`,\n                                children: uniqueCoordinateur.email_charge_developpement\n                              }) || \"\"\n                            })\n                          })]\n                        })]\n                      }), uniqueCoordinateur.site_internet && /*#__PURE__*/_jsx(Grid, {\n                        container: true,\n                        children: /*#__PURE__*/_jsx(Grid, {\n                          item: true,\n                          xs: 12,\n                          children: /*#__PURE__*/_jsx(Box, {\n                            mb: 1,\n                            children: /*#__PURE__*/_jsx(Button, {\n                              className: classes.btn,\n                              onClick: () => _handleClick(uniqueCoordinateur.site_internet),\n                              children: uniqueCoordinateur.site_internet || \"\"\n                            })\n                          })\n                        })\n                      })]\n                    })\n                  })\n                })\n              })]\n            })\n          })]\n        })]\n      })\n    })\n  });\n};\n\nexport const getServerSideProps = async () => {\n  const res = await fetch(getDepartments);\n  const departments = await res.json();\n  const res2 = await fetch(getAdherents);\n  const adherents = await res2.json();\n  const res3 = await fetch(getCoordinateurs);\n  const coordinateurs = await res3.json();\n  const res4 = await fetch(getExpertises);\n  const expertises = await res4.json();\n  return {\n    props: {\n      departments,\n      adherents,\n      coordinateurs,\n      expertises\n    }\n  };\n};\nexport default Region;","map":null,"metadata":{},"sourceType":"module"}