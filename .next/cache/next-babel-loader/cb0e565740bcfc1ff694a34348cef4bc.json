{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Container, Box, Grid, TextField, Button } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Layout, Title, Text } from '../../../components';\nimport { sendMail } from '../../../src/services/sendEmail';\nimport { getContactEmails } from '../../../utils';\nconst useStyles = makeStyles(theme => ({\n  textField: {\n    width: '100%'\n  },\n  btn: {\n    color: 'black',\n    borderColor: theme.palette.orange.main,\n    '&:hover': {\n      backgroundColor: theme.palette.golden.main,\n      color: '#fff',\n      borderColor: theme.palette.golden.main\n    }\n  }\n}));\n\nconst Entreprises = ({\n  contactEmails\n}) => {\n  const classes = useStyles();\n  const {\n    0: message,\n    1: setMessage\n  } = useState('');\n  const {\n    0: errorMessage,\n    1: setErrorMessage\n  } = useState(null);\n  const {\n    0: successMessage,\n    1: setSuccessMessage\n  } = useState(null);\n  const {\n    0: senderEmail,\n    1: setSenderEmail\n  } = useState('');\n  const {\n    0: errorSenderEmail,\n    1: setErrorSenderEmail\n  } = useState(null);\n  const minCharacters = 10;\n\n  const validateEmail = email => {\n    const re = /\\S+@\\S+\\.\\S+/;\n    return re.test(email);\n  };\n\n  const handleClick = async () => {\n    setErrorMessage(null);\n    setErrorSenderEmail(null);\n\n    if (message.length < minCharacters) {\n      setErrorMessage(`Votre message doit contenir au moins ${minCharacters} caractères.`);\n      return;\n    }\n\n    if (!validateEmail(senderEmail)) {\n      setErrorSenderEmail('Merci de saisir votre email de contact.');\n      return;\n    }\n\n    const emails = contactEmails.map(e => ({\n      email: e.email\n    }));\n    const variables = {\n      message,\n      emails,\n      senderEmail\n    };\n    const response = await sendMail(variables);\n\n    if (response) {\n      setMessage('');\n      setSenderEmail('');\n      alert('Message envoyé !');\n    } else {\n      alert(\"Erreur dans l'envoi du message. Veuillez recommencer.\");\n    }\n  };\n\n  return /*#__PURE__*/_jsx(Layout, {\n    children: /*#__PURE__*/_jsx(Box, {\n      mt: 7,\n      children: /*#__PURE__*/_jsxs(Container, {\n        maxWidth: \"lg\",\n        children: [/*#__PURE__*/_jsxs(Grid, {\n          container: true,\n          children: [/*#__PURE__*/_jsx(Box, {\n            mb: 2,\n            children: /*#__PURE__*/_jsx(Title, {\n              content: \"Vous souhaitez avoir des informations sur l\\u2019accompagnement propos\\xE9 par Mob\\u2019In France ou vous avez un projet de mobilit\\xE9 solidaire au sein de votre entreprise ?\",\n              size: \"h5\",\n              bold: true,\n              letterspacing: \"2px\"\n            })\n          }), /*#__PURE__*/_jsx(Box, {\n            mb: 2,\n            children: /*#__PURE__*/_jsx(Title, {\n              content: \"N\\u2019h\\xE9sitez pas \\xE0 nous laisser un message par le biais de ce formulaire de contact :\",\n              size: \"body1\",\n              color: \"#000\"\n            })\n          })]\n        }), /*#__PURE__*/_jsx(Grid, {\n          container: true,\n          children: /*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 12,\n            sm: 8,\n            md: 3,\n            children: [/*#__PURE__*/_jsx(Box, {\n              mt: 2,\n              mb: 4,\n              children: /*#__PURE__*/_jsx(TextField, {\n                className: classes.textField,\n                label: \"Saisissez votre email\",\n                value: senderEmail,\n                onChange: e => setSenderEmail(e.target.value),\n                variant: \"outlined\"\n              })\n            }), /*#__PURE__*/_jsx(Box, {\n              mb: 4,\n              children: /*#__PURE__*/_jsx(Text, {\n                color: \"#e5352c\",\n                children: errorSenderEmail\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(Grid, {\n          container: true,\n          children: [/*#__PURE__*/_jsxs(Grid, {\n            item: true,\n            xs: 12,\n            children: [/*#__PURE__*/_jsx(Box, {\n              mt: 2,\n              mb: 4,\n              children: /*#__PURE__*/_jsx(TextField, {\n                className: classes.textField,\n                label: \"Ecrivez-nous ici votre demande\",\n                multiline: true,\n                rows: 6,\n                value: message,\n                onChange: e => setMessage(e.target.value),\n                variant: \"outlined\"\n              })\n            }), /*#__PURE__*/_jsx(Box, {\n              mb: 4,\n              children: /*#__PURE__*/_jsx(Text, {\n                color: \"#e5352c\",\n                children: errorMessage\n              })\n            })]\n          }), /*#__PURE__*/_jsx(Grid, {\n            item: true,\n            xs: 12,\n            children: /*#__PURE__*/_jsx(Box, {\n              mb: 4,\n              children: /*#__PURE__*/_jsx(Button, {\n                className: classes.btn,\n                variant: \"outlined\",\n                onClick: () => handleClick(),\n                children: \"Envoyer\"\n              })\n            })\n          })]\n        })]\n      })\n    })\n  });\n};\n\nexport const getServerSideProps = async context => {\n  const res = await fetch(getContactEmails);\n  const emails = await res.json();\n  return {\n    props: {\n      contactEmails: emails\n    }\n  };\n};\nexport default Entreprises;","map":null,"metadata":{},"sourceType":"module"}