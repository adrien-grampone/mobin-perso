{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useContext } from 'react';\nimport { Container, Box, Grid, Card, Paper, Divider, TextField, Button, LinearProgress } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Layout, Title, Text } from '../../components';\nimport { login } from '../../lib/auth';\nimport AppContext from '../../context/AppContext';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    paper: {\n      padding: '2em',\n      border: \"2px solid \".concat(theme.palette.grey.main)\n    },\n    flexBox: {\n      display: 'flex',\n      alignItems: 'center'\n    },\n    textField: {\n      minWidth: '100%'\n    },\n    textFieldBox: {\n      textAlign: 'center'\n    },\n    btn: {\n      paddingLeft: '2em',\n      paddingRight: '2em',\n      color: theme.palette.blue.main,\n      fontWeight: 'bold',\n      letterSpacing: '2px',\n      borderColor: theme.palette.grey.main,\n      borderRadius: '1.5em',\n      '&:hover': {\n        backgroundColor: theme.palette.golden.main,\n        color: '#fff',\n        borderColor: theme.palette.golden.main\n      }\n    }\n  };\n});\n\nvar Login = function Login(_ref) {\n  _objectDestructuringEmpty(_ref);\n\n  var classes = useStyles();\n\n  var _useContext = useContext(AppContext),\n      setUser = _useContext.setUser;\n\n  var _useState = useState({\n    identifier: '',\n    password: ''\n  }),\n      variables = _useState[0],\n      setVariables = _useState[1];\n\n  var _useState2 = useState(false),\n      loader = _useState2[0],\n      setLoader = _useState2[1];\n\n  var _useState3 = useState(null),\n      error = _useState3[0],\n      setError = _useState3[1];\n\n  var validateEmail = function validateEmail(email) {\n    var re = /\\S+@\\S+\\.\\S+/;\n    return re.test(email);\n  };\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var identifier, password, response, user;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoader(true);\n              identifier = variables.identifier, password = variables.password;\n              setError(null);\n\n              if (validateEmail(identifier)) {\n                _context.next = 7;\n                break;\n              }\n\n              setLoader(false);\n              setError('Merci de saisir une adresse email.');\n              return _context.abrupt(\"return\");\n\n            case 7:\n              if (!(password.length < 1)) {\n                _context.next = 11;\n                break;\n              }\n\n              setLoader(false);\n              setError('Un mot de passe doit être saisi.');\n              return _context.abrupt(\"return\");\n\n            case 11:\n              _context.prev = 11;\n              _context.next = 14;\n              return login(variables);\n\n            case 14:\n              response = _context.sent;\n              user = response.data.user;\n              setUser(user);\n              setLoader(false);\n              _context.next = 25;\n              break;\n\n            case 20:\n              _context.prev = 20;\n              _context.t0 = _context[\"catch\"](11);\n              console.log(_context.t0);\n              setLoader(false);\n              setError('Connexion impossible avec ce couple email/mot de passe. Veuillez réessayer.');\n\n            case 25:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[11, 20]]);\n    }));\n\n    return function onSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  if (loader) {\n    return /*#__PURE__*/_jsx(LinearProgress, {\n      color: \"primary\"\n    });\n  }\n\n  return /*#__PURE__*/_jsx(Layout, {\n    children: /*#__PURE__*/_jsx(Box, {\n      mt: 7,\n      children: /*#__PURE__*/_jsx(Container, {\n        maxWidth: \"lg\",\n        children: /*#__PURE__*/_jsx(Grid, {\n          container: true,\n          direction: \"column\",\n          justify: \"center\",\n          alignItems: \"center\",\n          children: /*#__PURE__*/_jsx(Grid, {\n            item: true,\n            xs: 10,\n            md: 8,\n            children: /*#__PURE__*/_jsxs(Paper, {\n              className: classes.paper,\n              children: [/*#__PURE__*/_jsx(Box, {\n                mb: 4,\n                children: /*#__PURE__*/_jsxs(Text, {\n                  size: \"h5\",\n                  letterspacing: \"2px\",\n                  bold: true,\n                  children: [/*#__PURE__*/_jsx(\"span\", {\n                    style: {\n                      color: '#b1b3b4'\n                    },\n                    children: \"Connexion\"\n                  }), ' ', /*#__PURE__*/_jsx(\"span\", {\n                    style: {\n                      color: '#2699b0'\n                    },\n                    children: \"adh\\xE9rent\"\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(Divider, {\n                color: \"#b1b3b4\"\n              }), /*#__PURE__*/_jsx(Box, {\n                mt: 3,\n                mb: 2,\n                className: classes.textFieldBox,\n                children: /*#__PURE__*/_jsx(TextField, {\n                  value: variables.identifier,\n                  onChange: function onChange(event) {\n                    return setVariables(_objectSpread(_objectSpread({}, variables), {}, {\n                      identifier: event.target.value\n                    }));\n                  },\n                  label: \"Email\",\n                  variant: \"outlined\",\n                  size: \"small\",\n                  className: classes.textField\n                })\n              }), /*#__PURE__*/_jsx(Box, {\n                mt: 3,\n                mb: 2,\n                className: classes.textFieldBox,\n                children: /*#__PURE__*/_jsx(TextField, {\n                  type: \"password\",\n                  value: variables.password,\n                  onChange: function onChange(event) {\n                    return setVariables(_objectSpread(_objectSpread({}, variables), {}, {\n                      password: event.target.value\n                    }));\n                  },\n                  label: \"Mot de passe\",\n                  variant: \"outlined\",\n                  size: \"small\",\n                  className: classes.textField\n                })\n              }), error && /*#__PURE__*/_jsx(Box, {\n                mt: 3,\n                mb: 2,\n                children: /*#__PURE__*/_jsx(Text, {\n                  size: \"body1\",\n                  bold: true,\n                  color: \"#e5352c\",\n                  children: error\n                })\n              }), /*#__PURE__*/_jsx(Box, {\n                mt: 3,\n                mb: 2,\n                className: classes.textFieldBox,\n                children: /*#__PURE__*/_jsx(Button, {\n                  className: classes.btn,\n                  variant: \"outlined\",\n                  onClick: function onClick() {\n                    return onSubmit();\n                  },\n                  children: \"Valider\"\n                })\n              })]\n            })\n          })\n        })\n      })\n    })\n  });\n};\n\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}